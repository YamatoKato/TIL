# DID/VC の仕組み

## フロー

1. VC の発行

   1. 発行者は、対象者の属性情報を含む VC を作成します。
   2. VC の credentialSubject プロパティに対象者の DID を、issuer プロパティに発行者自身の DID を記載します。
   3. 発行者は自分の秘密鍵で VC に署名します。
   4. 発行者は署名済みの VC を対象者に送信します。

2. VC の保存

   1. 対象者は受け取った VC を自分のウォレット（端末内のアプリなど）に保存します。
   2. ウォレットでは VC と対象者の DID が紐づけて管理されます。
   3. 対象者の DID に対応する秘密鍵もウォレットで管理されます

3. 発行者の DID ドキュメントの公開

   1. 発行者は自分の DID ドキュメントを作成します。
   2. DID ドキュメントには、VC の署名検証に必要な公開鍵情報などを記載します。
   3. 発行者は DID ドキュメントを公開されたレジストリ（ブロックチェーンなど）に登録します。

4. VC の提示と検証

   1. 対象者は、検証者（サービスプロバイダなど）から VC の提示を求められます。
   2. 対象者はウォレットから必要な VC を選択します。
   3. 対象者は自分の秘密鍵を使って、提示する VC に署名します。これにより、VC を提示する正当な権限を持つことを証明します。
   4. 対象者は、署名済みの VC を検証者に送信します。
   5. 検証者は VC に記載された発行者の DID を取得します。
   6. 検証者は公開されたレジストリから、発行者の DID ドキュメントを取得します。
   7. 検証者は DID ドキュメントに記載された公開鍵を使って、VC の発行者の署名を検証します。
   8. 検証者は、対象者の DID に対応する公開鍵を使って、対象者の署名を検証します。
   9. 両方の署名が正当であれば、VC の内容を信頼できるものとして扱います。

5. VC のステータス確認（オプション）
   1. VC にステータス情報（失効情報など）が必要な場合、発行者はステータスリストの URL を DID ドキュメントの service プロパティに記載します。
   2. 検証者は DID ドキュメントからステータスリストの URL を取得し、VC のステータスを確認します。

# Mina Protcocol の 仕組み

- 2024/04/30
- キーワード: Blockchain,ZKP,Mina Protocol,Snarky,Zero-Knowledge Proof, L1

## 概要

[Introducing Mina Protocol](https://medium.com/minaprotocol/introducing-mina-protocol-d8b3a8e8b2bc)から翻訳

Mina Protocol は、ブロックチェーンのサイズを 22KB に維持することで、ブロックチェーンのサイズを小さく保ちながら、他のブロックチェーンと同等のセキュリティを提供するプロトコルです。Mina Protocol は、zk-SNARKs を使用して、ブロックチェーンのサイズを小さく保ちながら、他のブロックチェーンと同等のセキュリティを提供します。

### 背景

ビットコインやイーサリアムのようなレガシー・ブロックチェーンでは、新しい参加者が加わった場合、ネットワークの開始以来のすべての取引をチェックして正しさを検証しなければならない。ほとんどの人は、これらの重いチェーンを自分で検証するために必要なコンピューティングパワーを買う余裕がなく、ますます強力になる仲介者を信頼せざるを得なくなる。このことは、ほとんどの人々がピアツーピアで接続できなくなることを意味する。分散化が損なわれ、パワー・ダイナミクスが変化し、ネットワークが検閲に対してより脆弱になる。

## 特徴

- あらゆるデバイスの誰もがフルノードのようにチェーン全体を検証できるようにする

  - 資産のステーク量に関係なく誰でも検証可能

- ノードは再帰的 ZKP（zk-SNARKs）を使用して、ブロックチェーン全体を検証する

  - したがってブロックチェーン全体を約 22 キロバイトにしかならないという非常に小さなサイズに設計
      - 実はアーカイブノードと呼ばれるブロック情報全体を保存したノードがあるが、ブロック生成者はある一定期間で過去のブロック情報を22KBになるように破棄して良い

- Ouroboros Samasika（ウロボロス PoS） というコンセンサスを採用し、全ての参加者がフルノードのように検証できるようにする

- ゼロ知識スマートコントラクト（zkApps）をサポート
  - TypeScript で書かれたスマートコントラクトを zk-SNARKs でコンパイルして実行
  - Snarky というプログラミング言語で zk-SNARKs をサポート

- メインネットはローンチ済み
    - dapps(zkapps)を動かすためのTSライクな言語が6/4にローンチされる
    - 現状は、検証は早いけど、**ブロック生成に1.2分かかってる**
        - L2が立ち上がってきてる。
    - 

## 仕組み

### zk-SNARKs がどのように機能するか

zk-SNARK はブロックチェーン全体の状態を軽量のスナップショットとしてキャプチャし、チェーン全体の代わりにそれを送信する。巨大な生きた動物ではなく、象の絵葉書を友人に送るようなものだ。ネットワーク内で次のブロックが作成されると、ブロックチェーンの以前の状態のスナップショットを背景として、それ自身のスナップショットが作成される。その新しいスナップショットは、次のブロックの背景として使われる。むしろ驚くべきことに、無限の情報の証明を含むことができる一方で、スナップショットは常に同じサイズのままである。チェーンの内容を明らかにすることなくネットワークの状態を検証する小さな暗号証明書である。

### なぜ小さいサイズのブロックのみでチェーンを構成できるのか

比喩での説明

    ある地質学者が森をハイキングしていると、重い岩の列に出くわす。(チェーンのブロック）。彼女はその大理石の内部を調べたい。(その取引を検証する）。
    彼女はそれらを切り開き、研究し、発見を報告する。世界中の同僚（他のバリデーター）が大理石を見たいと言っているが、旅費は払えない。(完全にバリデートするノードを運営するコスト）。
    彼女の解決策は、それぞれのボルダーの写真を撮ることだ。(写真はゼロ知識証明、別名 zk-SNARK で、各ブロックのスナップショットである）。

    今、彼女は玉石を必要としない。
    ミナはフルノードが検証後にブロックを破棄し、各ブロックのスナップショットである zk-SNARK に置き換えることを可能にする。
    スナップショットの連鎖は、ブロックの連鎖よりはるかに改善されているが、問題は解決されていない。
    地質学者は斬新な解決策を持っている。彼女は最初の巨石の写真を撮り、次に 2 番目の巨石と最初の写真の写真を撮る。
    最初の写真は必要ない。2 枚目の写真に写っているのだから。
    彼女はそれぞれの岩のスナップショットを最新の写真と並べて撮り続け、最後の写真を同僚に送る。
    zk-SNARKは、3次元物体の2次元写真のようなものだ。より正確には、何かもっと大きなものの顕微鏡的に小さな暗号的証拠である。
    各ブロックは、それ自身のスナップショット画像にスナークされる。そして各スナップショットは、チェーン全体のフラクタルなメタイメージにスナークされる。
    こうしてMinaは、数百ギガバイトのチェーンを20キロバイトのzk-SNARKに圧縮する。


## まとめ/所感
- 自分しか信じないぞ
    - スマホで検証できる
- WEB2での証明関連(金融等)をオンチェーンで証明するのに真価を発揮するのでは？